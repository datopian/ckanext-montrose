{% extends "page.html" %}

{% block styles %}
    {% resource 'montrose/main' %}
    {% resource 'montrose/map' %}
    {% resource 'montrose/jqueryui' %}
{% endblock %}

{%  set color = "#" + country.montrose_dashboard_base_color %}

{% block page %}
    <header>
        <div class="container">
            <div class="row">
                <div class="col-sm-5 col-md-3 country-logo">
                    <a href="#"><img class="img-responsive" src="{{ country.image_display_url }}" height="130"
                                     alt="USEDATA logo"></a>
                </div>
                <div class="col-sm-5 col-md-3">
                  <h1 class="">{{ country.montrose_country_header }}</h1>
                </div>
              {% if country.montrose_lang_is_active == '1'%}
                <div class="col-sm-7 col-md-9 language-selector">
                    <ul class="list-inline">
                        <li class="active">
                            <img class="language-flag" src="/img/uk-flag-23x17.png" height="17" alt="UK flag">
                            <span class="language-name">En</span>
                        </li>
                        <li>
                            <img class="language-flag" src="/img/myanmar-flag-60x40.png" width="21" alt="BUR flag">
                            <a href="#">
                                <span class="language-name">Bur</span>
                            </a>
                        </li>
                    </ul>
                </div>
              {% endif %}
            </div>
        </div>
    </header>
    <nav class="main-navigation" style="background-color: {{ color }}">
        <div class="container">
            <ul class="list-inline">
                <li><a href="#">About</a></li>
                <li><a href="#">Help</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </nav>
    <div class="hero-map-wrap">
      <div class="hero-controls">
          <div class="hero-block hero-info-select hidden" id="map-info">
              <div class="media hero-info">
                  <div class="media-left">
                      <img id="map-info-img" class="language-flag" src="/images/usedata-info-icon.svg" width="41" alt="icon">
                  </div>
                  <div class="media-body">Select from the menu below the data that you wish to display on the map. Zoom in
                      for more detail using the zoom bar.
                  </div>
              </div>
              <div class="hero-select" style="border: 5px solid {{ color }}">
                  <select id="dataset" class="form-control" style="color: {{ color }};"></select>
              </div>
          </div>
          <div class="hero-block hero-country">
              <h2 class="hero-country-title" style="border-left: 5px solid {{ color }}; border-right: 5px solid {{ color }}; color: {{ color }}">Kenya</h2>
          </div>
      </div>
      <div
              data-module="montrose_map"
              data-module-id="hero_map"
              data-module-mapurl="{{ h.montrose_get_resource_url(country.montrose_map) }}"
              data-module-countryname="{{ country.display_name }}"
              id="hero_map"
      >
      </div>
    </div>
    <main class="container">
        <div class="graphs">
          <div class="row">
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_1,
                                                                   subheader=country.montrose_chart_1_subheader %}
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_2,
                                                                   subheader=country.montrose_chart_2_subheader %}
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_3,
                                                                   subheader=country.montrose_chart_3_subheader %}

              </div>
          <div class="row">
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_4,
                                                                   subheader=country.montrose_chart_4_subheader %}
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_5,
                                                                   subheader=country.montrose_chart_5_subheader %}
                {% snippet 'dashboards/snippets/show_charts.html', resource_view_id=country.montrose_chart_6,
                                                                   subheader=country.montrose_chart_6_subheader %}
          </div>
        </div>
        <div class="new-data">
            <h2 class="data-block-heading">Newly Released Data</h2>
            <div class="data-block">
                {{ h.snippet('dashboards/snippets/show_datasets.html',
                                                                      packages=h.montrose_get_newly_released_data(),
                                                                      datasets_group_name='newdata') }}
            </div>
        </div>

        <div class="all-data">
            {% set facets = {
          'fields': c.fields_grouped,
          'search': c.search_facets,
          'titles': [{"value": "groups", "name": "Themes"},
                     {"value": "tags", "name": "Tags"},
                     {"value": "res_format", "name": "Resource Format"},
                     {"value": "license_id", "name": "Licenses"},
                     {"value": "organization", "name": "Organizations"},],
          'translated_fields': c.translated_fields,
          'remove_field': c.remove_field } %}
            {% set sorting = [
          (_('Relevance'), 'score desc, metadata_modified desc'),
          (_('Name Ascending'), 'title_string asc'),
          (_('Name Descending'), 'title_string desc'),
          (_('Last Modified'), 'metadata_modified desc'),
          (_('Popular'), 'views_recent desc') if g.tracking_enabled else (false, false) ] %}
            {% snippet 'dashboards/snippets/search_form.html', form_id='dataset-search-form',
                                                           type='dataset',
                                                           query=c.q,
                                                           sorting=sorting,
                                                           sorting_selected=c.sort_by_selected,
                                                           count=c.page.item_count,
                                                           facets=facets,
                                                           show_empty=request.params,
                                                           error=c.query_error, fields=c.fields %}
            <div class="data-block-header">
                <div class="row">
                    <div class="col-md-2">
                        <h3 class="data-block-heading">Filter Data by:</h3>
                    </div>
                    {% for facet in facets.titles %}
                        {{ h.snippet('dashboards/snippets/facet_list.html',
                                                                           title=c.facet_titles[facet],
                                                                           name=facet) }}
                    {% endfor %}
                </div>
            </div>
            <div class="data-block">
                {{ h.snippet('dashboards/snippets/show_datasets.html',
                                                                      packages=c.page.items,
                                                                      datasets_group_name='search') }}
            </div>
        </div>
    </main>
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-2 col-lg-4">
                    <ul class="list-unstyled list-footer-nav">
                        <li><a href="#">About USEDATA</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Terms of Use</a></li>
                    </ul>
                </div>
                <div class="col-md-2 col-lg-3">
                    <ul class="list-inline list-social-buttons">
                        <li><a class="btn-animated" href="#"><img src="/img/facebook-circle-color.svg" width="50"
                                                                  height="50"
                                                                  alt="Share on Facebook"></a></li>
                        <li><a class="btn-animated" href="#"><img src="/img/instagram-circle-color.svg" width="50"
                                                                  height="50" alt="Share on Instagram"></a></li>
                        <li><a class="btn-animated" href="#"><img src="/img/twitter-circle-color.svg" width="50"
                                                                  height="50"
                                                                  alt="Tweet"></a></li>
                        <li><a class="btn-animated" href="#"><img src="/img/linkedin-circle-color.svg" width="50"
                                                                  height="50"
                                                                  alt="Share on LinkedIn"></a></li>
                    </ul>
                </div>
                <div class="col-md-8 col-lg-5">
                    <ul class="list-inline list-footer-logos">
                        <li><a href="#"><img src="/img/ukaid-logo-246x260.png" height="130" alt="UKAID logo"></a></li>
                        <li><a href="#"><img src="/img/montrose-logo-720x240.png" height="100" alt="Montrose logo"></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="copyright">Â© {{ country.montrose_country_copyright }}</div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
    <script>
        $(function () {
            // bind change event to select
            $('.montrose-filters').on('change', function () {
                var url = $(this).val(); // get selected value
                if (url) { // require a URL
                    window.location = url; // redirect
                }
                return false;
            });
        });

        function toggleResources(resourceId) {
          $('#' + resourceId).toggleClass('hidden');
        }

    </script>

{% endblock %}